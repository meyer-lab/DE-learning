## Methods

### PageRank node characterization




### Perturbation model

The model was constructed using Julia 1.5.0. The levels of mRNA in response to different perturbations are described by a unified system of ordinary differential equations. In this equation, $x_{i}^\mu$ represents the expression level of each gene under a specific knockout condition $\mu$. $\omega$ is a matrix representing interactions between different genes, specifically, $\omega_{ij}$ indicate interaction between gene j on gene i. To simulate the knockout condition, the corresponding column in $\omega$ is set to 0. All the elements in $\omega$ are also assumed to be constant after the introduction of a specific perturbation. We use function $\mathit{1 + tanh( )}$ to model the saturation effect of the interaction term and avoid negative values. Then $\epsilon$ is used as a saturation coefficient to bound the whole interaction term. Finally, we use $\alpha$ to characterize the degradation rate of each mRNA. The initial values of state variables x are approximated by $\mathit{\epsilon / \alpha}$, derived from steady-state assumption of the ODE equation while ignoring the effect of the $\omega$ matrix. The ODE system was numerically solved using the AutoVern7 method with low tolerance. In addition, the Jacobian matrix of the ODE equation was symbolically calculated and provided to the ODE solver for performance. The model performance was evaluated by difference between RNA-Seq Data and simulation output (the comparison was also visualized by using scatterplot of Model outputs vs RNA-Seq Measurements).

### Fused perturbation solving

The fitting of the model begins by initializing $\omega$ and $\epsilon$ by assuming the model is at steady state(eqn.1). As a result, we obtained two functions allowing to directly calculate $\omega$ and $\epsilon$(eqn.2, 3). In the third equation, U represents the steady-state values across knockdowns and control while $B_{[i]} = tan^{-1}(\frac{\alpha\mu_{i}}{\epsilon} - 1)$.

$$d\mu = \epsilon \cdot (1 + tanh(\omega \cdot \mu)) - \alpha\mu = 0_{(1)}$$

$$\epsilon_{overall} = \frac{mean\:of\:(\alpha\mu)}{mean\:of\:(1+tanh(\omega \cdot \mu))} _{(2)}$$

$$\omega^{T} = U^{T} \ast B^{T}_{(3)}$$

By iteratively calculating the $\omega$ and $\epsilon$ given the data and $\alpha$ for ~ 20 cycles, we can obtain the optimally initialized parameters. These parameters are then passed to a cost function(eqn.4) that calculate the norm of deviation from steady-state values, ensuring the output of model is consistent with experiment data. 

$$cost = norm(\epsilon \cdot (1 + tanh(\omega\cdot\mu)) - \alpha\mu)_{(4)}$$

In order to enforce certain characteristics of $\omega$, three different types of regularization are added to the cost function: 1).L1 regularization(eqn.5) - To enforce that most genes should not interact with each other 2).Orthogonality(eqn.6) - To prevent parallelism of gene interaction. Finally, this cost function is passed to an optimization function along with its gradient function to minimize the cost by tweaking $\omega$ and $\epsilon$.

$$L1\:regularization = norm(\omega, axis = column)_{(5)}$$

$$Orthogonality = norm(\omega^{T} \ast \omega - I), where\:I\:is\:an\:identity\:matrix_{(6)}$$

### Iterative matrix solving method

As described above, all the all the perturbations can be described at steady state by solving the matrix equation:

$$\bar{\epsilon} \left( 1 + \tanh⁡ \left(W U \right) \right) = \alpha X$$

Given steady-state measurements, $\alpha$ cannot be identified separately from $\bar{\epsilon}$ and so we set the value of the former to 0.1. This leaves two co-dependent unknowns $\bar{\epsilon}$ and W to be determined. However, given some specified value of W, ε can be found using the geometric mean of each column from the ratio of $\alpha X$ and $1 + tanh(WU)$. We additionally limited the minimum value of both expressions to be 0.1, to avoid issues arising from genes with no expression. Conversely, with fixed $\bar{\epsilon}$ one can solve for W using the expression:

$$B = \tanh^(-1)⁡(αX/\bar{\epsilon} - 1)$$

$$W = ( {U'}^{*}  B' )'$$

Where $^{*}$ indicates the pseudoinverse of $U’$. The values were restricted to the domain -0.9 to 0.9 before atanh transformation to reduce the effect of outlier values. Consequently, one can iteratively solve for the overall solution by repeated and alternating solving for each variable. We found this to generally converge within 10 iterations.

Conveniently, this approach can also account for various regularization for the structure of $W$, including orthogonality and sparsity, through generalizations of the pseudoinverse [@DOI: 10.1137/15M1028479; @10.1137/0119015]. In any practical situation the pseudoinverse is also the predominant cost for solving and is sure to be far less costly than generic optimization with or without solving the ordinary differential equations.
